{"ast":null,"code":"var fs = require(\"fs\");\n\nconst CLIENT_FILES_OPT = \"clientFiles\";\n/**\n * Enable a element on clients\n * @param clients\n * @param ui\n * @param bs\n * @returns {Function}\n */\n\nvar types = {\n  \"css\": \"text/css\",\n  \"js\": \"application/javascript\"\n};\n\nfunction enableElement(clients, ui, bs) {\n  return function (file) {\n    var uiItem = ui.getOptionIn([CLIENT_FILES_OPT, file.name]);\n    var item = uiItem.toJS();\n    var enableFn = uiItem.getIn([\"callbacks\", \"enable\"]);\n\n    if (item.active) {\n      return;\n    }\n\n    ui.setOptionIn([CLIENT_FILES_OPT, item.name, \"active\"], true, {\n      silent: true\n    });\n\n    if (enableFn) {\n      enableFn.call(ui, item);\n    }\n\n    if (item.file && !item.served) {\n      ui.setOptionIn([CLIENT_FILES_OPT, item.name, \"served\"], true, {\n        silent: true\n      });\n      bs.serveFile(item.src, {\n        type: types[item.type],\n        content: fs.readFileSync(item.file)\n      });\n    }\n\n    addElement(clients, ui.getOptionIn([CLIENT_FILES_OPT, item.name]).toJS());\n  };\n}\n/**\n * @param clients\n * @param ui\n * @returns {Function}\n */\n\n\nfunction disableElement(clients, ui) {\n  return function (file) {\n    var uiItem = ui.getOptionIn([CLIENT_FILES_OPT, file.name]);\n    var item = uiItem.toJS();\n    var disableFn = uiItem.getIn([\"callbacks\", \"disable\"]);\n\n    if (disableFn) {\n      disableFn.call(ui, item);\n    }\n\n    ui.setOptionIn([CLIENT_FILES_OPT, item.name, \"active\"], false, {\n      silent: true\n    });\n    removeElement(clients, item.id);\n  };\n}\n/**\n * @param clients\n * @param item\n */\n\n\nfunction addElement(clients, item) {\n  clients.emit(\"ui:element:add\", item);\n}\n/**\n * @param clients\n * @param id\n */\n\n\nfunction removeElement(clients, id) {\n  clients.emit(\"ui:element:remove\", {\n    id: id\n  });\n}\n\nmodule.exports.addElement = addElement;\nmodule.exports.removeElement = removeElement;\nmodule.exports.enable = enableElement;\nmodule.exports.disable = disableElement;","map":{"version":3,"names":["fs","require","CLIENT_FILES_OPT","types","enableElement","clients","ui","bs","file","uiItem","getOptionIn","name","item","toJS","enableFn","getIn","active","setOptionIn","silent","call","served","serveFile","src","type","content","readFileSync","addElement","disableElement","disableFn","removeElement","id","emit","module","exports","enable","disable"],"sources":["/Users/johnberetty/node_modules/browser-sync-ui/lib/client-elements.js"],"sourcesContent":["var fs = require(\"fs\");\n\nconst CLIENT_FILES_OPT = \"clientFiles\";\n\n/**\n * Enable a element on clients\n * @param clients\n * @param ui\n * @param bs\n * @returns {Function}\n */\n\nvar types = {\n    \"css\": \"text/css\",\n    \"js\":  \"application/javascript\"\n};\n\nfunction enableElement (clients, ui, bs) {\n\n    return function (file) {\n\n        var uiItem   = ui.getOptionIn([CLIENT_FILES_OPT, file.name]);\n        var item     = uiItem.toJS();\n        var enableFn = uiItem.getIn([\"callbacks\", \"enable\"]);\n\n        if (item.active) {\n            return;\n        }\n\n        ui.setOptionIn([CLIENT_FILES_OPT, item.name, \"active\"], true, {silent: true});\n\n        if (enableFn) {\n            enableFn.call(ui, item);\n        }\n\n        if (item.file && !item.served) {\n\n            ui.setOptionIn([CLIENT_FILES_OPT, item.name, \"served\"], true, {silent: true});\n\n            bs.serveFile(item.src, {\n                type:    types[item.type],\n                content: fs.readFileSync(item.file)\n            });\n        }\n\n        addElement(clients, ui.getOptionIn([CLIENT_FILES_OPT, item.name]).toJS());\n    };\n}\n\n/**\n * @param clients\n * @param ui\n * @returns {Function}\n */\nfunction disableElement (clients, ui) {\n\n    return function (file) {\n        var uiItem    = ui.getOptionIn([CLIENT_FILES_OPT, file.name]);\n        var item      = uiItem.toJS();\n        var disableFn = uiItem.getIn([\"callbacks\", \"disable\"]);\n\n        if (disableFn) {\n            disableFn.call(ui, item);\n        }\n\n        ui.setOptionIn([CLIENT_FILES_OPT, item.name, \"active\"], false, {silent: true});\n\n        removeElement(clients, item.id);\n    };\n}\n\n/**\n * @param clients\n * @param item\n */\nfunction addElement (clients, item) {\n\n    clients.emit(\"ui:element:add\", item);\n}\n\n/**\n * @param clients\n * @param id\n */\nfunction removeElement(clients, id) {\n\n    clients.emit(\"ui:element:remove\", {id: id});\n}\n\nmodule.exports.addElement    = addElement;\nmodule.exports.removeElement = removeElement;\nmodule.exports.enable        = enableElement;\nmodule.exports.disable       = disableElement;\n\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}