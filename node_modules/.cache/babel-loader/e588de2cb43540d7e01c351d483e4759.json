{"ast":null,"code":"\"use strict\";\n\nvar _ = require(\"./lodash.custom\");\n\nvar Immutable = require(\"immutable\");\n\nvar snippetUtils = require(\"./snippet\").utils;\n\nmodule.exports = {\n  /**\n   *\n   * @this {BrowserSync}\n   * @returns {String}\n   */\n  \"client:js\": function (hooks, data) {\n    var js = snippetUtils.getClientJs(data.port, data.options);\n    return hooks.reduce(function (acc, hook) {\n      if (typeof hook === \"function\") {\n        return acc.concat(hook);\n      }\n\n      return acc.concat(String(hook));\n    }, [js]);\n  },\n\n  /**\n   * @this {BrowserSync}\n   * @returns {Array}\n   */\n  \"client:events\": function (hooks, clientEvents) {\n    hooks.forEach(function (hook) {\n      var result = hook(this);\n\n      if (Array.isArray(result)) {\n        clientEvents = _.union(clientEvents, result);\n      } else {\n        clientEvents.push(result);\n      }\n    }, this);\n    return clientEvents;\n  },\n\n  /**\n   * @returns {Array}\n   */\n  \"server:middleware\": function (hooks, initial) {\n    initial = initial || [];\n\n    _.each(hooks, function (hook) {\n      var result = hook(this);\n\n      if (Array.isArray(result)) {\n        result.forEach(function (res) {\n          if (_.isFunction(res)) {\n            initial = initial.push(res);\n          }\n        });\n      } else {\n        if (_.isFunction(result)) {\n          initial = initial.push(result);\n        }\n      }\n    }, this);\n\n    return initial;\n  },\n\n  /**\n   * @param {Array} hooks\n   * @param {Map|List} initial\n   * @param pluginOptions\n   * @returns {any}\n   */\n  \"files:watch\": function (hooks, initial, pluginOptions) {\n    var opts;\n\n    if (pluginOptions) {\n      opts = Immutable.fromJS(pluginOptions);\n      opts.forEach(function (value, key) {\n        if (!value) {\n          return;\n        }\n\n        var files = value.get(\"files\");\n\n        if (files) {\n          var fileArg = require(\"./cli/cli-options\").makeFilesArg(files);\n\n          if (fileArg) {\n            initial = initial.set(key, Immutable.fromJS(fileArg));\n          }\n        }\n      });\n    }\n\n    return initial;\n  }\n};","map":{"version":3,"mappings":"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","names":["_","require","Immutable","snippetUtils","utils","module","exports","hooks","data","js","getClientJs","port","options","reduce","acc","hook","concat","String","clientEvents","forEach","result","Array","isArray","union","push","initial","each","res","isFunction","pluginOptions","opts","fromJS","value","key","files","get","fileArg","makeFilesArg","set"],"sources":["../lib/hooks.js"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}