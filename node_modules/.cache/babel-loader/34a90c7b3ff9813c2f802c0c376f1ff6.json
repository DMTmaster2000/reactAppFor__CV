{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar immutable_1 = require(\"immutable\");\n\nfunction addToFilesOption(incoming) {\n  if (!incoming.get(\"watch\")) {\n    return [incoming, []];\n  }\n\n  var serverPaths = [];\n  var fromServeStatic = incoming.get(\"serveStatic\", immutable_1.List([])).toArray();\n  var ssPaths = fromServeStatic.reduce(function (acc, ss) {\n    if (typeof ss === \"string\") {\n      return acc.concat(ss);\n    }\n\n    if (ss.dir && typeof ss.dir === \"string\") {\n      return acc.concat(ss);\n    }\n\n    return acc;\n  }, []);\n  ssPaths.forEach(function (p) {\n    return serverPaths.push(p);\n  });\n  var server = incoming.get(\"server\");\n\n  if (server) {\n    if (server === true) {\n      serverPaths.push(\".\");\n    }\n\n    if (typeof server === \"string\") {\n      serverPaths.push(server);\n    }\n\n    if (immutable_1.List.isList(server) && server.every(function (x) {\n      return typeof x === \"string\";\n    })) {\n      server.forEach(function (s) {\n        return serverPaths.push(s);\n      });\n    }\n\n    if (immutable_1.Map.isMap(server)) {\n      var baseDirProp = server.get(\"baseDir\");\n      var baseDirs = immutable_1.List([]).concat(baseDirProp).filter(Boolean);\n      baseDirs.forEach(function (s) {\n        return serverPaths.push(s);\n      });\n    }\n  }\n\n  var output = incoming.update(\"files\", function (files) {\n    return immutable_1.List([]).concat(files, serverPaths).filter(Boolean);\n  });\n  return [output, []];\n}\n\nexports.addToFilesOption = addToFilesOption;","map":{"version":3,"mappings":";;;;;;AAAA;;AAGA,SAAgBA,gBAAhB,CAAiCC,QAAjC,EAAwD;EACpD,IAAI,CAACA,QAAQ,CAACC,GAAT,CAAa,OAAb,CAAL,EAA4B;IACxB,OAAO,CAACD,QAAD,EAAW,EAAX,CAAP;EACH;;EAED,IAAIE,WAAW,GAAG,EAAlB;EAEA,IAAMC,eAAe,GAAGH,QAAQ,CAACC,GAAT,CAAa,aAAb,EAA4BG,iBAAK,EAAL,CAA5B,EAAsCC,OAAtC,EAAxB;EACA,IAAMC,OAAO,GAAGH,eAAe,CAACI,MAAhB,CAAuB,UAACC,GAAD,EAAMC,EAAN,EAAQ;IAC3C,IAAI,OAAOA,EAAP,KAAc,QAAlB,EAA4B;MACxB,OAAOD,GAAG,CAACE,MAAJ,CAAWD,EAAX,CAAP;IACH;;IACD,IAAIA,EAAE,CAACE,GAAH,IAAU,OAAOF,EAAE,CAACE,GAAV,KAAkB,QAAhC,EAA0C;MACtC,OAAOH,GAAG,CAACE,MAAJ,CAAWD,EAAX,CAAP;IACH;;IACD,OAAOD,GAAP;EACH,CARe,EAQb,EARa,CAAhB;EAUAF,OAAO,CAACM,OAAR,CAAgB,aAAC;IAAI,kBAAW,CAACC,IAAZ,CAAiBC,CAAjB;EAAmB,CAAxC;EAEA,IAAMC,MAAM,GAAGf,QAAQ,CAACC,GAAT,CAAa,QAAb,CAAf;;EACA,IAAIc,MAAJ,EAAY;IACR,IAAIA,MAAM,KAAK,IAAf,EAAqB;MACjBb,WAAW,CAACW,IAAZ,CAAiB,GAAjB;IACH;;IACD,IAAI,OAAOE,MAAP,KAAkB,QAAtB,EAAgC;MAC5Bb,WAAW,CAACW,IAAZ,CAAiBE,MAAjB;IACH;;IACD,IAAIX,iBAAKY,MAAL,CAAYD,MAAZ,KAAuBA,MAAM,CAACE,KAAP,CAAa,aAAC;MAAI,cAAOC,CAAP,KAAa,QAAb;IAAqB,CAAvC,CAA3B,EAAqE;MACjEH,MAAM,CAACH,OAAP,CAAe,aAAC;QAAI,kBAAW,CAACC,IAAZ,CAAiBM,CAAjB;MAAmB,CAAvC;IACH;;IACD,IAAIf,gBAAIgB,KAAJ,CAAUL,MAAV,CAAJ,EAAuB;MACnB,IAAMM,WAAW,GAAGN,MAAM,CAACd,GAAP,CAAW,SAAX,CAApB;MACA,IAAMqB,QAAQ,GAAGlB,iBAAK,EAAL,EACZM,MADY,CACLW,WADK,EAEZE,MAFY,CAELC,OAFK,CAAjB;MAGAF,QAAQ,CAACV,OAAT,CAAiB,aAAC;QAAI,kBAAW,CAACC,IAAZ,CAAiBM,CAAjB;MAAmB,CAAzC;IACH;EACJ;;EAED,IAAMM,MAAM,GAAGzB,QAAQ,CAAC0B,MAAT,CAAgB,OAAhB,EAAyB,iBAAK;IACzC,OAAOtB,iBAAK,EAAL,EACFM,MADE,CACKiB,KADL,EACYzB,WADZ,EAEFqB,MAFE,CAEKC,OAFL,CAAP;EAGH,CAJc,CAAf;EAKA,OAAO,CAACC,MAAD,EAAS,EAAT,CAAP;AACH;;AA9CDG","names":["addToFilesOption","incoming","get","serverPaths","fromServeStatic","immutable_1","toArray","ssPaths","reduce","acc","ss","concat","dir","forEach","push","p","server","isList","every","x","s","isMap","baseDirProp","baseDirs","filter","Boolean","output","update","files","exports"],"sources":["../../../lib/cli/transforms/addToFilesOption.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}