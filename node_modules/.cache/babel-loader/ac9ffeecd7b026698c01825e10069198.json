{"ast":null,"code":"/**\n * Module dependencies.\n */\nvar Polling = require('./polling');\n\nvar util = require('util');\n/**\n * Module exports.\n */\n\n\nmodule.exports = XHR;\n/**\n * Ajax polling transport.\n *\n * @api public\n */\n\nfunction XHR(req) {\n  Polling.call(this, req);\n}\n/**\n * Inherits from Polling.\n */\n\n\nutil.inherits(XHR, Polling);\n/**\n * Overrides `onRequest` to handle `OPTIONS`..\n *\n * @param {http.IncomingMessage}\n * @api private\n */\n\nXHR.prototype.onRequest = function (req) {\n  if ('OPTIONS' === req.method) {\n    var res = req.res;\n    var headers = this.headers(req);\n    headers['Access-Control-Allow-Headers'] = 'Content-Type';\n    res.writeHead(200, headers);\n    res.end();\n  } else {\n    Polling.prototype.onRequest.call(this, req);\n  }\n};\n/**\n * Returns headers for a response.\n *\n * @param {http.IncomingMessage} request\n * @param {Object} extra headers\n * @api private\n */\n\n\nXHR.prototype.headers = function (req, headers) {\n  headers = headers || {};\n\n  if (req.headers.origin) {\n    headers['Access-Control-Allow-Credentials'] = 'true';\n    headers['Access-Control-Allow-Origin'] = req.headers.origin;\n  } else {\n    headers['Access-Control-Allow-Origin'] = '*';\n  }\n\n  return Polling.prototype.headers.call(this, req, headers);\n};","map":{"version":3,"names":["Polling","require","util","module","exports","XHR","req","call","inherits","prototype","onRequest","method","res","headers","writeHead","end","origin"],"sources":["/Users/johnberetty/node_modules/engine.io/lib/transports/polling-xhr.js"],"sourcesContent":["\n/**\n * Module dependencies.\n */\n\nvar Polling = require('./polling');\nvar util = require('util');\n\n/**\n * Module exports.\n */\n\nmodule.exports = XHR;\n\n/**\n * Ajax polling transport.\n *\n * @api public\n */\n\nfunction XHR (req) {\n  Polling.call(this, req);\n}\n\n/**\n * Inherits from Polling.\n */\n\nutil.inherits(XHR, Polling);\n\n/**\n * Overrides `onRequest` to handle `OPTIONS`..\n *\n * @param {http.IncomingMessage}\n * @api private\n */\n\nXHR.prototype.onRequest = function (req) {\n  if ('OPTIONS' === req.method) {\n    var res = req.res;\n    var headers = this.headers(req);\n    headers['Access-Control-Allow-Headers'] = 'Content-Type';\n    res.writeHead(200, headers);\n    res.end();\n  } else {\n    Polling.prototype.onRequest.call(this, req);\n  }\n};\n\n/**\n * Returns headers for a response.\n *\n * @param {http.IncomingMessage} request\n * @param {Object} extra headers\n * @api private\n */\n\nXHR.prototype.headers = function (req, headers) {\n  headers = headers || {};\n\n  if (req.headers.origin) {\n    headers['Access-Control-Allow-Credentials'] = 'true';\n    headers['Access-Control-Allow-Origin'] = req.headers.origin;\n  } else {\n    headers['Access-Control-Allow-Origin'] = '*';\n  }\n\n  return Polling.prototype.headers.call(this, req, headers);\n};\n"],"mappings":"AACA;AACA;AACA;AAEA,IAAIA,OAAO,GAAGC,OAAO,CAAC,WAAD,CAArB;;AACA,IAAIC,IAAI,GAAGD,OAAO,CAAC,MAAD,CAAlB;AAEA;AACA;AACA;;;AAEAE,MAAM,CAACC,OAAP,GAAiBC,GAAjB;AAEA;AACA;AACA;AACA;AACA;;AAEA,SAASA,GAAT,CAAcC,GAAd,EAAmB;EACjBN,OAAO,CAACO,IAAR,CAAa,IAAb,EAAmBD,GAAnB;AACD;AAED;AACA;AACA;;;AAEAJ,IAAI,CAACM,QAAL,CAAcH,GAAd,EAAmBL,OAAnB;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEAK,GAAG,CAACI,SAAJ,CAAcC,SAAd,GAA0B,UAAUJ,GAAV,EAAe;EACvC,IAAI,cAAcA,GAAG,CAACK,MAAtB,EAA8B;IAC5B,IAAIC,GAAG,GAAGN,GAAG,CAACM,GAAd;IACA,IAAIC,OAAO,GAAG,KAAKA,OAAL,CAAaP,GAAb,CAAd;IACAO,OAAO,CAAC,8BAAD,CAAP,GAA0C,cAA1C;IACAD,GAAG,CAACE,SAAJ,CAAc,GAAd,EAAmBD,OAAnB;IACAD,GAAG,CAACG,GAAJ;EACD,CAND,MAMO;IACLf,OAAO,CAACS,SAAR,CAAkBC,SAAlB,CAA4BH,IAA5B,CAAiC,IAAjC,EAAuCD,GAAvC;EACD;AACF,CAVD;AAYA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAEAD,GAAG,CAACI,SAAJ,CAAcI,OAAd,GAAwB,UAAUP,GAAV,EAAeO,OAAf,EAAwB;EAC9CA,OAAO,GAAGA,OAAO,IAAI,EAArB;;EAEA,IAAIP,GAAG,CAACO,OAAJ,CAAYG,MAAhB,EAAwB;IACtBH,OAAO,CAAC,kCAAD,CAAP,GAA8C,MAA9C;IACAA,OAAO,CAAC,6BAAD,CAAP,GAAyCP,GAAG,CAACO,OAAJ,CAAYG,MAArD;EACD,CAHD,MAGO;IACLH,OAAO,CAAC,6BAAD,CAAP,GAAyC,GAAzC;EACD;;EAED,OAAOb,OAAO,CAACS,SAAR,CAAkBI,OAAlB,CAA0BN,IAA1B,CAA+B,IAA/B,EAAqCD,GAArC,EAA0CO,OAA1C,CAAP;AACD,CAXD"},"metadata":{},"sourceType":"script"}