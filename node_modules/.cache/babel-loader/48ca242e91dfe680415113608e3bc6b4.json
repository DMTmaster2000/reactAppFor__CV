{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar url = require(\"url\");\n\nvar immutable_1 = require(\"immutable\");\n\nfunction handleProxyOption(incoming) {\n  var value = incoming.get(\"proxy\");\n  var mw;\n  var target;\n\n  if (!value || value === true) {\n    return [incoming, []];\n  }\n\n  if (typeof value !== \"string\") {\n    target = value.get(\"target\");\n    mw = value.get(\"middleware\");\n  } else {\n    target = value;\n    value = immutable_1.Map({});\n  }\n\n  if (!target.match(/^(https?):\\/\\//)) {\n    target = \"http://\" + target;\n  }\n\n  var parsedUrl = url.parse(target);\n\n  if (!parsedUrl.port) {\n    parsedUrl.port = \"80\";\n  }\n\n  var out = {\n    target: parsedUrl.protocol + \"//\" + parsedUrl.host,\n    url: immutable_1.Map(parsedUrl)\n  };\n\n  if (mw) {\n    out.middleware = mw;\n  }\n\n  var proxyOutput = value.mergeDeep(out);\n  return [incoming.set(\"proxy\", proxyOutput), []];\n}\n\nexports.handleProxyOption = handleProxyOption;","map":{"version":3,"mappings":";;;;;;AAAA;;AACA;;AAIA,SAAgBA,iBAAhB,CAAkCC,QAAlC,EAAyD;EACrD,IAAIC,KAAK,GAAGD,QAAQ,CAACE,GAAT,CAAa,OAAb,CAAZ;EACA,IAAIC,EAAJ;EACA,IAAIC,MAAJ;;EAEA,IAAI,CAACH,KAAD,IAAUA,KAAK,KAAK,IAAxB,EAA8B;IAC1B,OAAO,CAACD,QAAD,EAAW,EAAX,CAAP;EACH;;EAED,IAAI,OAAOC,KAAP,KAAiB,QAArB,EAA+B;IAC3BG,MAAM,GAAGH,KAAK,CAACC,GAAN,CAAU,QAAV,CAAT;IACAC,EAAE,GAAGF,KAAK,CAACC,GAAN,CAAU,YAAV,CAAL;EACH,CAHD,MAGO;IACHE,MAAM,GAAGH,KAAT;IACAA,KAAK,GAAGI,gBAAI,EAAJ,CAAR;EACH;;EAED,IAAI,CAACD,MAAM,CAACE,KAAP,CAAa,gBAAb,CAAL,EAAqC;IACjCF,MAAM,GAAG,YAAYA,MAArB;EACH;;EAED,IAAMG,SAAS,GAAGC,GAAG,CAACC,KAAJ,CAAUL,MAAV,CAAlB;;EAEA,IAAI,CAACG,SAAS,CAACG,IAAf,EAAqB;IACjBH,SAAS,CAACG,IAAV,GAAiB,IAAjB;EACH;;EAED,IAAMC,GAAG,GAAqB;IAC1BP,MAAM,EAAEG,SAAS,CAACK,QAAV,GAAqB,IAArB,GAA4BL,SAAS,CAACM,IADpB;IAE1BL,GAAG,EAAEH,gBAAIE,SAAJ;EAFqB,CAA9B;;EAKA,IAAIJ,EAAJ,EAAQ;IACJQ,GAAG,CAACG,UAAJ,GAAiBX,EAAjB;EACH;;EAED,IAAMY,WAAW,GAAGd,KAAK,CAACe,SAAN,CAAgBL,GAAhB,CAApB;EAEA,OAAO,CAACX,QAAQ,CAACiB,GAAT,CAAa,OAAb,EAAsBF,WAAtB,CAAD,EAAqC,EAArC,CAAP;AACH;;AAvCDG","names":["handleProxyOption","incoming","value","get","mw","target","immutable_1","match","parsedUrl","url","parse","port","out","protocol","host","middleware","proxyOutput","mergeDeep","set","exports"],"sources":["../../../lib/cli/transforms/handleProxyOption.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}