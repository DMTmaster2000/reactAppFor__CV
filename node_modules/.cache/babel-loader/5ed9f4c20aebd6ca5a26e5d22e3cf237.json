{"ast":null,"code":"\"use strict\";\n\nvar _ = require(\"./lodash.custom\");\n\nvar fileUtils = {\n  /**\n   * React to file-change events that occur on \"core\" namespace only\n   * @param bs\n   * @param data\n   */\n  changedFile: function (bs, data) {\n    /**\n     * If the event property is undefined, infer that it's a 'change'\n     * event due the fact this handler is for emitter.emit(\"file:changed\")\n     */\n    if (_.isUndefined(data.event)) {\n      data.event = \"change\";\n    }\n    /**\n     * Chokidar always sends an 'event' property - which could be\n     * `add` `unlink` etc etc so we need to check for that and only\n     * respond to 'change', for now.\n     */\n\n\n    if (bs.options.get(\"watchEvents\").indexOf(data.event) > -1) {\n      if (!bs.paused && data.namespace === \"core\") {\n        bs.events.emit(\"file:reload\", fileUtils.getFileInfo(data, bs.options));\n      }\n    }\n  },\n\n  /**\n   * @param data\n   * @param options\n   * @returns {{assetFileName: *, fileExtension: String}}\n   */\n  getFileInfo: function (data, options) {\n    data.ext = require(\"path\").extname(data.path).slice(1);\n    data.basename = require(\"path\").basename(data.path);\n    var obj = {\n      ext: data.ext,\n      path: data.path,\n      basename: data.basename,\n      event: data.event,\n      type: \"inject\"\n    }; // RELOAD page\n\n    if (!_.includes(options.get(\"injectFileTypes\").toJS(), obj.ext)) {\n      obj.url = obj.path;\n      obj.type = \"reload\";\n    }\n\n    obj.path = data.path;\n    obj.log = data.log;\n    return obj;\n  }\n};\nmodule.exports = fileUtils;","map":{"version":3,"mappings":"AAAA;;AAEA,IAAIA,CAAC,GAAGC,OAAO,CAAC,iBAAD,CAAf;;AAEA,IAAIC,SAAS,GAAG;EACZ;;;;;EAKAC,WAAW,EAAE,UAASC,EAAT,EAAaC,IAAb,EAAiB;IAC1B;;;;IAIA,IAAIL,CAAC,CAACM,WAAF,CAAcD,IAAI,CAACE,KAAnB,CAAJ,EAA+B;MAC3BF,IAAI,CAACE,KAAL,GAAa,QAAb;IACH;IACD;;;;;;;IAKA,IAAIH,EAAE,CAACI,OAAH,CAAWC,GAAX,CAAe,aAAf,EAA8BC,OAA9B,CAAsCL,IAAI,CAACE,KAA3C,IAAoD,CAAC,CAAzD,EAA4D;MACxD,IAAI,CAACH,EAAE,CAACO,MAAJ,IAAcN,IAAI,CAACO,SAAL,KAAmB,MAArC,EAA6C;QACzCR,EAAE,CAACS,MAAH,CAAUC,IAAV,CACI,aADJ,EAEIZ,SAAS,CAACa,WAAV,CAAsBV,IAAtB,EAA4BD,EAAE,CAACI,OAA/B,CAFJ;MAIH;IACJ;EACJ,CA3BW;;EA4BZ;;;;;EAKAO,WAAW,EAAE,UAASV,IAAT,EAAeG,OAAf,EAAsB;IAC/BH,IAAI,CAACW,GAAL,GAAWf,OAAO,CAAC,MAAD,CAAP,CACNgB,OADM,CACEZ,IAAI,CAACa,IADP,EAENC,KAFM,CAEA,CAFA,CAAX;IAGAd,IAAI,CAACe,QAAL,GAAgBnB,OAAO,CAAC,MAAD,CAAP,CAAgBmB,QAAhB,CAAyBf,IAAI,CAACa,IAA9B,CAAhB;IAEA,IAAIG,GAAG,GAAG;MACNL,GAAG,EAAEX,IAAI,CAACW,GADJ;MAENE,IAAI,EAAEb,IAAI,CAACa,IAFL;MAGNE,QAAQ,EAAEf,IAAI,CAACe,QAHT;MAINb,KAAK,EAAEF,IAAI,CAACE,KAJN;MAKNe,IAAI,EAAE;IALA,CAAV,CAN+B,CAc/B;;IACA,IAAI,CAACtB,CAAC,CAACuB,QAAF,CAAWf,OAAO,CAACC,GAAR,CAAY,iBAAZ,EAA+Be,IAA/B,EAAX,EAAkDH,GAAG,CAACL,GAAtD,CAAL,EAAiE;MAC7DK,GAAG,CAACI,GAAJ,GAAUJ,GAAG,CAACH,IAAd;MACAG,GAAG,CAACC,IAAJ,GAAW,QAAX;IACH;;IAEDD,GAAG,CAACH,IAAJ,GAAWb,IAAI,CAACa,IAAhB;IACAG,GAAG,CAACK,GAAJ,GAAUrB,IAAI,CAACqB,GAAf;IAEA,OAAOL,GAAP;EACH;AAzDW,CAAhB;AA4DAM,MAAM,CAACC,OAAP,GAAiB1B,SAAjB","names":["_","require","fileUtils","changedFile","bs","data","isUndefined","event","options","get","indexOf","paused","namespace","events","emit","getFileInfo","ext","extname","path","slice","basename","obj","type","includes","toJS","url","log","module","exports"],"sources":["../lib/file-utils.js"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}